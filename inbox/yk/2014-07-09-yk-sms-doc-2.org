---
layout: post
title: "愉快网短信接口文档 Ver2.0"
date: 2013-05-16 10:01
comments: true
categories: yk
---
#+OPTIONS: ^:nil

error: "missing_required_parameter",
message: "参数缺失:m"
* 调用参数

** Ver1.0 版所需参数

   | 必须 | 参数名      | 取值范围         | 默认值 | 说明                                                                    |
   |------+-------------+------------------+--------+-------------------------------------------------------------------------|
   |      | u, user     | 由系统分配可用值 |        | 标识用户身份。必须使用系统分配的用户名。                                |
   | 是   | m, mobile   | (\d+,)*\d+       |        | 短信接受方手机号码，如群发号码间用','隔开，V1.0 群发数量限制最多 5 个号码  |
   | 是   | c, content  | 短信文本         |        | 短信内容。                                                              |
   |      | gw, gateway | 由系统分配可用值 | AUTO   | 必须大写，指定短信网关发送短信。注：指定网关需确保有此权限。            |

** Ver1.1 版所需参数

   | 必须 | 参数名      | 取值范围            | 默认值   | 说明                                                                          |
   |------+-------------+---------------------+----------+-------------------------------------------------------------------------------|
   |      | ver         | [1.0,1.1]           | 1.0      | 版本号，不指定或指定为1.0 时运行在兼容1.0模式。指定1.1后V1.1 增加的参数才生效 |
   | 是   | m, mobile   |                     |          | 同 V1.0，但 V1.1 群发数量只受 POST 数据大小限制                               |
   | 是   | c, content  |                     |          | 同 V1.0                                                                       |
   |      | gw, gateway |                     | AUTO     | 同 V1.0，但可指定多个网关，如：&gw=MDSP,EMSP 表示先用 MDSP，如出错用EMSP 重试 |
   |      | u, user     |                     | TEST     | 弃用，仅为兼容 V1.0                                                           |
   |------+-------------+---------------------+----------+-------------------------------------------------------------------------------|
   | 是   | token       | 系统分配            |          | 用户公钥令牌，由系统分配。用于标识身份                                        |
   | 是   | signature   | 根据token等计算得出 |          | 签名密钥。根据公钥和密钥等计算，算法请参照接口提供的客户端代码包。            |
   | 是   | timestamp   | 当前时间戳          |          | 签名时间。注意：签名 60 秒后失效。需服务器对时                                |
   |      | sendtime    | 时间戳              | 立即发送 |                                                                               |

   注：所有参数数据，以 POST 的方式传递给短信接口

* 系统返回值

  短信接口以 JSON 对象格式返回数据，返回值如下：

  | 属性    | 类型            | 说明                                                     |
  |---------+-----------------+----------------------------------------------------------|
  | status  | ok/fail         | 调用是否成功                                             |
  | job     | uuid 形式字符串 | 任务已进入队列则返回 job_id ，将来可凭此查询任务处理结果 |
  | error   | 字符串          | 错误类型。只有 status==fail，才会输出错误相关结果。      |
  | message | 字符串          | 错误详细说明。                                           |

* 附录

** 附一、错误列表

   | 错误码 | 错误类型                   | 错误详细说明         |
   |--------+----------------------------+----------------------|
   |    401 | unauthorized               | 未认证               |
   |    450 | error_version              | 版本号错误           |
   |    451 | missing_required_parameter | 参数缺失             |
   |    461 | expired_token              | 令牌已过期           |
   |    462 | expired_authentication     | 认证已过期           |
   |    500 | sms_gateway_down           | 无法连接到短信网关   |
   |    502 | sms_gateway_error          | 网关报错             |
   |    604 | illegal_content            | 短信内容错误         |
   |    900 | queue_server_error         | 无法连接到队列服务器 |
